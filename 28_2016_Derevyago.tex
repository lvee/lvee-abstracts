\documentclass[10pt, a5paper]{article}
\input{preamble.tex}
\begin{document}
\title{Криптографический алгоритм DersCrypt\footnote{\url{derevyago@yahoo.com}, \url{http://lvee.org/ru/abstracts/193}}}
\author{Sergey Derevyago, Minsk, Belarus}
\maketitle
\begin{abstract}
An original block symmetric cryptography algorithm DersCrypt is presented. Specifics of implementation is discussed, as far as reference and production implementations.
\end{abstract}
DersCrypt "--- это блочный симметричный криптографический алгоритм, построенный на не использовавшихся ранее принципах. Суть работы алгоритма состоит в переводе числа из одной системы счисления в другую, перестановке <<цифр>> и обратном переводе в исходную систему счисления.

DersCrypt обладает следующими достоинствами:

\begin{itemize}
  \item Нет ограничений на длину ключа;
  \item Криптоалгоритм предельно прост для понимания и реализации;
  \item Криптоалгоритм является открытым и свободным для использования.
\end{itemize}

Впервые криптоалгоритм был представлен в феврале 2004 года в виде сообщения в профильные ньюсгруппы UseNet~\cite{Derevyago1}. Наиболее ценное обсуждение произошло в конференции fido7.ru.crypt сети FidoNet. В апреле 2005 года увидела свет первая версия DersCrypt, заметно отличавшаяся от того, что было представлено в самом начале~\cite{Derevyago2}. Текущей является версия алгоритма 1.1.

\subsection*{Особенности алгоритма}

Базовый алгоритм DersCrypt состоит из следующих шагов:

\begin{enumerate}
  \item Текст для шифрования рассматривается как неотрицательное число $A_{1}$ в некоторой системе счисления $S_{1}$ по основанию $B_{1}$.
  \item Число $A_{1}$ переводится в другую систему счисления $S_{2}$ по основанию $B_{2}$. Число $B_{2}$ является ключом.
  \item Цифры числа $A_{1}$ в системе счисления $S_{2}$ переставляются, в результате чего получается число $A_{2}$. Перестановка задается значением ключа.
  \item Число $A_{2}$ переводится в исходную систему счисления $S_{1}$.
  \item Число $A_{2}$ в системе счисления $S_{1}$ и является результатом шифрования.
\end{enumerate}

Сам по себе базовый алгоритм DersCrypt непригоден к практическому применению в силу существования следующих эффективных способов атаки:

\begin{enumerate}
  \item Если зашифровать два числа, отличающихся только значением младшего бита, то разность зашифрованных чисел, очевидно, будет равна $B^{n}_{2}$ для некоторого $n$.
  \item Существует и более эффективный способ атаки: Max Alekseyev указал на то, что имея число $A_{1}$ в системе счисления по основанию $B_{2}$ и число $A_{2}$, полученное из $A_{1}$ произвольной перестановкой цифр, разность $A_{1} - A_{2}$ всегда делится на $B_{2} - {1}$.
\end{enumerate}

Таким образом, DersCrypt не должен сводиться к простой перестановке цифр в некоторой системе счисления. Решение достаточно очевидно: перед применением базового алгоритма, число $A_{1}$ превращается в некоторое число $A'_{1}$ посредством приписывания к $A_{1}$ некоторого количества случайных байт слева и справа. После дешифрования приписанные байты достаточно просто отбросить, получив исходное число $A_{1}$.

В силу того, что действительно случайные байты довольно сложно получить на практике, в DersCrypt используется предварительное шифрование числа $A_{1}$ базовым алгоритмом и извлечение из полученного числа $A_{2}$ последовательности бит нужной длины. На самом деле, для учета значения предыдущего зашифрованного блока текста, процедура формирования псевдослучайной битовой последовательности чуть более усложнена. Ознакомиться с ней можно непосредственно по коду эталонной реализации DersCrypt, которая, благодаря детальным комментариям~\cite{Derevyago3}, определяет сам алгоритм и предназначена для практического исследования его свойств.

\subsection*{Реализации алгоритма}

Языком эталонной реализации выбрана Java, а исходный код оформлен исходя из упрощения понимания, а не производительности и/или простоты включения во внешние проекты.

Также имеются реализации на Java~\cite{Derevyago4} и С++~\cite{Derevyago5}, предназначенные для практического использования. Об их сравнительной производительности можно судить по следующей таблице, в которой приведена скорость шифрования в килобайтах в секунду на 256-битном ключе для двух компьютеров разной архитектуры:

\begin{table}[h!]
  \centering
  \begin{tabular}{|p{1.5cm}|p{1.8cm}|p{1.8cm}|p{1.8cm}|p{1.8cm}|}
\hline
                  & Эталонная реализация &  Java-реализация  &  C++-реализация универсальная  &  C++-реализация оптимизированная  \\
\hline
     Pentium4    &  52.5 K/s            &  74.2 K/s         &  351.8 K/s     &             612.7 K/s      \\
\hline
     Athlon       &  86.4 K/s            &  127.2 K/s        &  1149.2 K/s    &  1404.6 K/s     \\
\hline
  \end{tabular}
\end{table}

Как можно видеть, оптимизированная C++ реализация в 8-11 раз быстрее Java реализации, которая, в свою очередь, на 40-50 процентов быстрее эталонной. Судя по всему, неприемлемой производительностью Java реализации обязаны стандартному классу java.math.BigInteger, чей код никак нельзя признать оптимальным.

Исходный код реализаций алгоритма свободно распространяется с правом копирования, использования, модификации, продажи и распространения при условии сохранения сведений об авторе~\cite{Derevyago4} ~\cite{Derevyago5}.

\begin{thebibliography}{99}
\bibitem{Derevyago1} Анонс алгоритма \url{http://ders.stml.net/crypt/derscrypt/orig.html}
\bibitem{Derevyago2} С. Деревяго. Криптографический алгоритм DersCrypt \url{http://ders.angen.net/crypt}
\bibitem{Derevyago3} Комментарии к эталонной реализации алгоритма \url{http://ders.stml.net/crypt/derscrypt/derscrypt.html#3.3}
\bibitem{Derevyago4} Java-реализация алгоритма \url{http://ders.stml.net/crypt/derscrypt/java/src.zip}
\bibitem{Derevyago5} Реализация алгоритма на С++ \url{http://ders.stml.net/crypt/derscrypt/cpp/src.zip}
\end{thebibliography}
\end{document}
