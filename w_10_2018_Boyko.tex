\documentclass[10pt, a5paper]{article}
\input{preamble.tex}
\begin{document}
\title{Системы распознавания речи с открытым исходным кодом\footnote{\url{daniil.boyko.2017@gmail.com}, \url{https://lvee.org/en/abstracts/273}}}
\author{Даниил Бойко, Минск, Belarus}
\maketitle
\begin{abstract}
We provide brief overview and comparison of  three open-source speech-recognition systems: CMUSphinx, Kaldi, DeepSpeech.  
\end{abstract}
\subsection*{Введение}

Сейчас существует огромное разнообразие коммерческих систем распознавания речи:

\begin{itemize}
  \item Google
  \item Amazon Alexa
  \item IBM Watson
  \item Siri
  \item Yandex
\end{itemize}

Они часто свободны для использования и предлагают открытые API (ссылки). Качество распознавания такими системами тоже довольно высокое. Какие же у них есть недостатки и зачем возится с системами с открытыми исходниками?

\begin{itemize}
  \item Перечисленные выше системы работают через интернет, соответственно, если нет сети они не работают
  \item Нет пользовательского контроля: как мы увидим, качество распознавания зависит от используемой языковой модели (в разных контекстах разная вероятность разных слов, etc). Стандартные системы используют усредненную модель языка, либо модель, разработанную для их задач, а не для наших
  \item Пересылка данных через сеть может вносить большие задержки при плохом качестве связи
  \item Проблемы с приватностью
\end{itemize}

В этом докладе мы рассмотрим три свободные системы распознавания речи и попробуем сравнить их качество:

\begin{enumerate}
  \item CMU Sphinx
  \item Kaldi
  \item Mozilla DeepSpeech
\end{enumerate}

\subsection*{CMU Sphinx}

CMU Sphinx (если кратко, то просто Sphinx)~--- группа систем распознавания речи разработанных университетом Карнеги Меллон. Она включает в себя серию систем распознавания (Sphinx 2~--- 4) и акустическую тренировочную модель (SphinxTrain).

В 2000 компонент системы распознавания речи Sphinx 2 был опубликован как открытый код, а в 2001 компонент Sphinx 3. На данный момент активно разрабатывается Sphinx 4 (написанный на Java, удобный для встраивания в серверные системы) и\linebreak PocketSphinx (написанный на C и удобный для встраиваемых систем). Распространяется под лицензией BSD.

В этом докладе мы будем в основном рассматривать\linebreak PocketSphinx.

\subsubsection*{Установка}

Pocketsphinx доступен в качестве пакета в большинстве линуксов. 
Для работы ему также необходимы файлы языковой модели, файлы акустической модели и словарь произношения (фонетический словарь).

\textbf{Акустическая модель}~--- задает способ отображения потока речи (представленных так называемыми кепстральными коэффициентами ) в фонемы (обозначения звуков речи, которые используются в словарях произношения). В pocketsphinx используются скрытые марковские модели (HMM) в качестве акустической модели.

\textbf{Словарь произношения}~--- содержит транскрипцию произношения слов. Отображает слово в набор фонем.

\textbf{Языковая модель}~--- задает вероятности разных слов и словосочетаний, которые будут встречаться в произносимом тексте. Очень сильно зависит от тематики текста.

Для английского языка языковые модели доступны из дистрибутива. Для большинства других языков (в т.ч.  и для русского) файлы языковой, акустической модели и словари доступны на \url{http://www.voxforge.org}.

\subsubsection*{Запуск}

С командной строки запускается так (онлайновый режим, работа с микрофона):

\verb@ALSA_OSS_PCM_DEVICE="hw:CARD=MS,DEV=0" aoss pocketsphinx_@
\verb@continuous -hmm ru-RU-adapt/ -dict msu_ru_nsh.dic -lm <some@
\verb@ language model>  -inmic yes@

\verb@-hmm задает путь к директории акустической модели@

\verb@-lm путь к языковой модели@

\verb@-dict путь к словарю произношения@

Оффлайновый режим (транскрипция текста, запуск на wav файле):

\verb@pocketsphinx_continuous -infile sample.wav > decode.txt@

\subsection*{Kaldi}

Kaldi~--- это набор инструментов для распознавания речи, написанный на языке C++, имеющий лицензию Apache v2.0. В больше степени Kaldi предназначена для исследования распознавания речи.

Одной из целью Kaldi было иметь современный и гибкий код, написанный на C++, который можно было бы легко расширять и изменять.

Kaldi включает следующие возможности:

\begin{itemize}
  \item Обширная поддержка линейной алгебры~--- включена матричная библиотека, которая оборачивает стандартные процедуры BLAS и LAPACK.
  \item Расширяемая конструкция~--- алгоритмы написаны наиболее универсальным способом.
  \item Открытая лицензия~--- код находится под лицензией Apache 2.0 которая является одной из наименее ограничительных лицензий.
  \item Полные рецепты~--- цель Kaldi предоставить полные рецепты построения систем распознавания речи, которые работают из широко доступных баз данных. Это важный аспект Kaldi, так как код публично доступен под лицензией, которая разрешает изменения и переиздание. Kaldi призывает людей выпускать свой код вместе с каталогом скриптов аналогично тому, как делает сама Kaldi
\end{itemize}

Некоторые особенности системы Kaldi:

\begin{itemize}
  \item Код Kaldi весь или почти весь тщательно оттестирован
  \item Код Kaldi легок для понимания~--- несмотря на то что инструментарий Kaldi очень большой, разработчики старались, чтобы каждую часть кода можно было бы разобрать без особых усилий. Некоторые участки кода дублировались специально для того, чтобы код был понятнее.
  \item Код Kaldi легко использовать повторно и рефакторить~--- разработчики старались сделать код настолько менее связным на сколько это возможно. В общем случае это значит, что какой-либо файл содержит директив \#include настолько мало, на сколько это возможно.
  \item Сейчас Kaldi содержит скрипты для большинства стандартных задач.
\end{itemize}

\subsubsection*{Установка}

\verb@Git clone https://github.com/kaldi-asr/kaldi@

В склонированном репозитории есть файл INSTALL, который содержит инструкции по компиляции в нем написано следующее:

\begin{enumerate}
  \item go to tools/  and follow INSTALL instructions there.
  \item go to src/ and follow INSTALL instructions there.
\end{enumerate}

\subsubsection*{Запуск}

Вместе с системой распознавания Kaldi предоставляет большое количество примеров использования системы. Все примеры находится в папке egs.

Оффлайновый режим (транскрипция текста, запуск на wav файле):

Есть специальный скрипт в примерах, который предназначен для распознавания wav файла. Он находится по следующему пути: \url{egs/apiai\_decode/s5/recognize-wav.sh}. Для распознавания этот скрипт запускается передавая ему путь к wav файлу. Например:

\verb@./recognize-wav.sh sample.wav@

\subsection*{Mozilla DeepSpeech}

DeepSpeech~--- это движок с открытым исходным кодом, для преобразования речи в текст. Для обучения используются модель, обученную методами машинного обучения, на основе глубоких речевых исследованиях Байду. DeepSpeech использует проект TensorFlow чтобы облегчить реализацию

\subsubsection*{Установка}

Весь проект находится на github по адресу: \url{https://github.com/mozilla/DeepSpeech#getting-the-pre-trained-model}

Для того, чтобы установить:
\verb@pip install deepspeech@
или
				
\verb@pip install deepspeech-gpu@
или
	
\verb@git clone https://github.com/mozilla/DeepSpeech@

Скачиваем модель для распознавания:
wget -O~--- 

\verb@https://github.com/mozilla/DeepSpeech/releases/download/@

\verb@v0.1.1/deepspeech-0.1.1-models.tar.gz | tar xvfz -@

\subsubsection*{Запуск}

Оффлайновый режим (транскрипция текста, запуск на wav файле):

\verb@deepspeech models/output_graph.pb my_audio_file.wav @
 
\verb@models/alphabet.txt@

\subsection*{Сравнение систем}

\subsubsection*{Метрики качества}

WER~--- это производная от величины называемой «расстояние Левенштейна», которая вычисляется на уровне слов, а не на уровне фонем. Расстояние Левенштейна~--- это минимальное количество операций вставки одного символа, удаления одного символа и замены одного символа на другой, необходимых для превращения одной строки в другую.

\verb@WER = (S + D + I)/N = (S + D + I)/(S + D + C)@

\begin{itemize}
  \item S~--- число операций замены слов
  \item D~--- число операций удаления слов
  \item I~--- число операций вставки слов
  \item C~--- количество правильно распознанных слов
  \item N~--- общее количество слов
\end{itemize}

SER~--- это общая метрика для определения точности системы распознавания. SER представляет собой показатель отношения количества неправильно распознанных предложений к количеству всех предложений.

\verb@SER = Sв / S@

\begin{itemize}
  \item Sв~--- количество предложений распознанных без ошибок
  \item S~--- общее количество предложений
\end{itemize}

SF~--- это общая метрика для определения скорости распознавания системы. SF представляет собой показатель отношения времени распознавания к длительности распознаваемого сигнала.

\verb@SF = Tрасп / T@

\begin{itemize}
  \item Tрасп~--- время распознавания сигнала
  \item T~--- длительность, измеряется в долях реального времен
\end{itemize}

\subsubsection*{Результаты сравнений}

Результаты сравнений приведены в следующей таблице.

%\begin{turn}{90} 
%\usepackage{array}
\newcolumntype{L}[1]{>{\raggedright\let\newline\\\arraybackslash\hspace{0pt}}m{#1}}
\centering
\begin{table}
  \begin{tabular}{|L{2cm}|L{3cm}|L{2cm}|L{2cm}|}
\hline      & CMU~Sphinx ~ (pocketsphinx)  & Kaldi  & DeepSpeech  \\ \hline
%      &   &   &   \\
     \textbf{WER, \%}  &  42.01  &  22.81  &  29.96  \\ \hline
     \textbf{SER, \%}  &  84.24  &  76.00  &  84.00  \\ \hline
     \textbf{SF, \%}  &  34.83  &  149.31  &  215.65  \\ \hline
     \textbf{Язык}  &  C/Java  &  C++  &  Python  \\ \hline
     \textbf{Структура}  &  Модульная  &  Модульная  &  Модульная  \\ \hline
     \textbf{Документа\-ция}  &  Подробная онлайн-документация, видео-уроки на YouTube  &  Подробная онлайн-документация  &  Подробная онлайн-документация  \\ \hline
     \textbf{Поддержи\-ваемые
ОС}  &  Linux, Mac OS, Windows, Android  &  Linux, Windows  &  Linux, Mac OS,
Windows, Android  \\ \hline
     \textbf{Интерфейс}  &  Консольный, API  &  Консольный  &  Консольный  \\ \hline
     \textbf{Языки}  &  Множество языков, в т.\,ч. экзотические  &  Английский  &  Английский  \\ \hline
     \textbf{Лицензия}  &  BSD  &  Apache v2.0 (BSD-подобная)  &  Mozilla Public License 2.0 (BSD-подобная)  \\ \hline
 \end{tabular}
\end{table}
%\end{turn}
 

\end{document}
